<script>
logger_output = "";
function logger(s) {
    let textarea_debug = document.getElementById("debug");
    logger_output += s + "\n";
    textarea_debug.value = logger_output;
}
function execute() {
    try {
    let textarea_code = document.getElementById("code");
    let textarea_input = document.getElementById("input");
    let textarea_output = document.getElementById("output");
    let textarea_expression = document.getElementById("expression");
    let network = eval("(function() { return " + textarea_code.value + "})()").finalize();
    textarea_output.value = network.predict(textarea_input.value);
    textarea_expression.value = network.to_expression();
    } catch(e) {
    let textarea_debug = document.getElementById("debug");
    textarea_debug.value = e.toString();
    }
}
function learn() {
    try {
    let textarea_code = document.getElementById("code");
    let textarea_input = document.getElementById("input");
    let textarea_output = document.getElementById("output");
    let textarea_expected = document.getElementById("expected");
    let textarea_expression = document.getElementById("expression");
    let network = eval("(function() { return " + textarea_code.value + "})()").finalize();
    network.learn(textarea_input.value, textarea_expected.value);
    textarea_output.value = network.predict(textarea_input.value);
    textarea_expression.value = network.to_expression();
    } catch(e) {
    let textarea_debug = document.getElementById("debug");
    textarea_debug.value = e.toString();
    }
}
function reload() { window.location.reload(true) }
</script>

<div>
<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.0.0/dist/tf.min.js"></script>
<script src="../src/js/detail/expression.js"></script>
<script src="../src/js/nerve.js"></script>

<textarea rows="10" cols="30" id="code">expression.network(1,expression.layers(expression.layer(1), expression.layer("softmax")),expression.collectors(expression.collector(" ab")),0.001)</textarea>
<button onclick="execute()">RUN</button>
<textarea rows="1" cols="30" id="output"></textarea>
<textarea rows="1" cols="30" id="input"></textarea>
<textarea rows="10" cols="30" id="expression"></textarea>
<button onclick="learn()">LEARN</button>
<textarea rows="1" cols="30" id="expected"></textarea>
</div>
<div>
<textarea rows="20" cols="100" id="debug"></textarea>
</div>
<div>
<button onclick="reload()">RELOAD</button>
</div>
